<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mini-Telegraf</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; background: #0e1621; color: white; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        #chat-container { width: 100%; max-width: 500px; height: 80vh; display: flex; flex-direction: column; background: #17212b; box-shadow: 0 10px 20px rgba(0,0,0,0.5); border-radius: 10px; overflow: hidden; }
        #messages { flex: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 10px; background-image: url('https://user-images.githubusercontent.com/15075759/28719144-86dc0f70-73b1-11e7-911d-60d70fcded21.png'); background-size: cover; }
        .msg { background: #242f3d; padding: 10px 15px; border-radius: 15px; max-width: 75%; align-self: flex-start; word-wrap: break-word; }
        .msg.my { background: #2b5278; align-self: flex-end; color: #fff; }
        .msg strong { display: block; font-size: 0.8em; color: #5288c1; margin-bottom: 4px; }
        .input-area { padding: 15px; display: flex; background: #17212b; border-top: 1px solid #0e1621; }
        input { flex: 1; background: #242f3d; border: none; color: white; padding: 12px; border-radius: 8px; outline: none; }
        button { background: none; border: none; color: #5288c1; cursor: pointer; font-weight: bold; padding: 0 15px; font-size: 16px; }
    </style>
</head>
<body>

<div id="chat-container">
    <div id="messages"></div>
    <div class="input-area">
        <input type="text" id="msgInput" placeholder="Написать сообщение..." autocomplete="off">
        <button id="sendBtn">ОТПРАВИТЬ</button>
    </div>
</div>

<script src="/socket.io/socket.io.js"></script>
<script>
    const socket = io();
    const input = document.getElementById('msgInput');
    const sendBtn = document.getElementById('sendBtn');
    const messages = document.getElementById('messages');

    const userName = prompt("Твой никнейм для Telegraf:") || "User_" + Math.floor(Math.random()*1000);

    function sendMessage() {
        if (input.value.trim()) {
            socket.emit('message', { user: userName, text: input.value });
            input.value = '';
        }
    }

    sendBtn.onclick = sendMessage;
    input.onkeypress = (e) => { if (e.key === 'Enter') sendMessage(); };

    socket.on('message', (data) => {
        const div = document.createElement('div');
        div.className = 'msg' + (data.user === userName ? ' my' : '');
        div.innerHTML = `<strong>${data.user}</strong>${data.text}`;
        messages.appendChild(div);
        messages.scrollTop = messages.scrollHeight;
    });
</script>
</body>
</html>
